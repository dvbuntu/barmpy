<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BARN &mdash; BARMPy 0.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Math" href="math.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> BARMPy
          </a>
              <div class="version">
                0.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="math.html">Math</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">BARN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#nn">NN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#barn-class">BARN Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coming-soon">Coming Soon</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BARMPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">BARN</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="barn">
<h1>BARN<a class="headerlink" href="#barn" title="Permalink to this heading"></a></h1>
<p>One of the primary ensembles available in BARMPy (currently the only one) is that of the single hidden layer Neural Network.  When you collect several of these NNs, you have Bayesian Additive Regression Networks (BARN)</p>
<section id="nn">
<h2>NN<a class="headerlink" href="#nn" title="Permalink to this heading"></a></h2>
<p>Before building an ensemble, it’s helpful to understand the core component that goes into it.  In this case, we use a neural network implemented in <cite>sklearn</cite> with a few extra methods to ease their use in BARN.  Eventually, this class will inherit from an abstract one for general BARM components.</p>
<span class="target" id="module-barmpy.barn.NN"></span><p>Neural Network with single hidden layer implemented with sklearn.</p>
<p>Includes methods to do MCMC transitions and calculations.</p>
</section>
<section id="barn-class">
<h2>BARN Class<a class="headerlink" href="#barn-class" title="Permalink to this heading"></a></h2>
<p>Armed with a core <cite>NN</cite> class above, we can train the entire ensemble following our Bayesian procedure.</p>
<span class="target" id="module-barmpy.barn.BARN"></span><p>Bayesian Additive Regression Networks ensemble.</p>
<p>Specify and train an array of neural nets with Bayesian posterior.</p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this heading"></a></h3>
<p>Let’s walk through a minimal example training an ensemble with BARN.  Start by generating some data (or reading in some of your own).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="c1"># make a simply linear relationship</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
</pre></div>
</div>
<p>Now we’ll initialize a <cite>BARN</cite> setup with 3 <cite>NN</cite>’s.  We’ll use the default</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">barmpy.barn</span> <span class="kn">import</span> <span class="n">BARN</span><span class="p">,</span> <span class="n">NN</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">BARN</span><span class="p">(</span><span class="n">num_nets</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dname</span><span class="o">=</span><span class="s1">&#39;example&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">setup_nets</span><span class="p">()</span>
</pre></div>
</div>
<p>Actually running the model is simple, but you can tweak the MCMC parameters to your liking.  After the specified number of MCMC iterations, your model is ready for pointwise inference by using the last ensemble in the chain.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">total_iters</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">Yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">Y</span><span class="o">-</span><span class="n">Yhat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span> <span class="c1"># relative error</span>
</pre></div>
</div>
</section>
<section id="coming-soon">
<h3>Coming Soon<a class="headerlink" href="#coming-soon" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Visualization example</p></li>
<li><p>Tweaking MCMC parameters</p></li>
<li><p>Hyperparameter tuning with cross-validation</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="math.html" class="btn btn-neutral float-left" title="Math" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Danielle Van Boxel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>